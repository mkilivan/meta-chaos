SUMMARY = "HomeKit support for the impatient"
LICENSE = "Unlicense & MIT & ISC & Apache-2.0"
LIC_FILES_CHKSUM = "file://LICENSE;md5=34f8c1142fd6208a8be89399cb521df9 \
                    file://node_modules/multicast-dns-service-types/LICENSE;md5=a75272c6b584d0f8e2c1676b4e72469e \
                    file://node_modules/color-convert/LICENSE;md5=9bdadfc9fbb3ab8d5a6d591bdbd52811 \
                    file://node_modules/is-date-object/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/hap-nodejs/LICENSE;md5=34f8c1142fd6208a8be89399cb521df9 \
                    file://node_modules/color-name/LICENSE;md5=d301869b39e08b33665b7c4f16b8e41d \
                    file://node_modules/fast-srp-hap/LICENSE;md5=ebe2e123fdf76caa6bf6762e1133b698 \
                    file://node_modules/multicast-dns/LICENSE;md5=a75272c6b584d0f8e2c1676b4e72469e \
                    file://node_modules/object.assign/LICENSE;md5=2b439ca9e99134dee172a7cc6d989174 \
                    file://node_modules/is-negative-zero/LICENSE;md5=d22b3eb619d81197fd4f3ca47c2c1ea5 \
                    file://node_modules/regexp.prototype.flags/LICENSE;md5=de214a0e2991ba4bb802f96348cbb1ce \
                    file://node_modules/regexp.prototype.flags/node_modules/es-abstract/LICENSE;md5=53ffc646fdb83e45279cfe7105e5157b \
                    file://node_modules/function-bind/LICENSE;md5=e7417c1a8ad83f88bcac21ad440d48b2 \
                    file://node_modules/foreach/LICENSE;md5=b2225091caf5effa363ef7016fa2b0ba \
                    file://node_modules/isarray/LICENSE;md5=a5df515ef062cc3affd8c0ae59c059ec \
                    file://node_modules/is-callable/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/is-map/LICENSE;md5=c18cc44449ec61c93b216bf74e6c4fa4 \
                    file://node_modules/which-typed-array/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/which-typed-array/node_modules/es-abstract/LICENSE;md5=53ffc646fdb83e45279cfe7105e5157b \
                    file://node_modules/is-typed-array/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/is-typed-array/node_modules/es-abstract/LICENSE;md5=53ffc646fdb83e45279cfe7105e5157b \
                    file://node_modules/ms/license.md;md5=fd56fd5f1860961dfa92d313167c37a6 \
                    file://node_modules/is-string/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/is-number-object/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/buffer-from/LICENSE;md5=46513463e8f7d9eb671a243f0083b2c6 \
                    file://node_modules/is-set/LICENSE;md5=c18cc44449ec61c93b216bf74e6c4fa4 \
                    file://node_modules/es-abstract/LICENSE;md5=53ffc646fdb83e45279cfe7105e5157b \
                    file://node_modules/is-arguments/LICENSE;md5=d22b3eb619d81197fd4f3ca47c2c1ea5 \
                    file://node_modules/object-inspect/LICENSE;md5=288162f1d1bfa064f127f2b42d2a656f \
                    file://node_modules/debug/LICENSE;md5=ddd815a475e7338b0be7a14d8ee35a99 \
                    file://node_modules/string.prototype.trimstart/LICENSE;md5=1e241a19d2d112b1db1a5c1c23216939 \
                    file://node_modules/string.prototype.trimstart/node_modules/es-abstract/LICENSE;md5=53ffc646fdb83e45279cfe7105e5157b \
                    file://node_modules/is-boolean-object/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/decimal.js/LICENCE.md;md5=623ad17c6f9ac75f709ea8787bbe8d32 \
                    file://node_modules/has-symbols/LICENSE;md5=afee57a289508ed4df3456667778aaf6 \
                    file://node_modules/has/LICENSE-MIT;md5=d000afc3c9ff3501a5610197db76a246 \
                    file://node_modules/is-symbol/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/qrcode-terminal/LICENSE;md5=beed67299fff1e7b91b5e4c3e43b505b \
                    file://node_modules/es-get-iterator/LICENSE;md5=375dc7ca936a14e9c29418d5263bd066 \
                    file://node_modules/es-get-iterator/node_modules/es-abstract/LICENSE;md5=53ffc646fdb83e45279cfe7105e5157b \
                    file://node_modules/which-boxed-primitive/LICENSE;md5=375dc7ca936a14e9c29418d5263bd066 \
                    file://node_modules/is-bigint/LICENSE;md5=291be6f19f64188a89ffd5180aea06f7 \
                    file://node_modules/has-flag/license;md5=915042b5df33c31a6db2b37eadaa00e3 \
                    file://node_modules/ansi-styles/license;md5=915042b5df33c31a6db2b37eadaa00e3 \
                    file://node_modules/chalk/license;md5=915042b5df33c31a6db2b37eadaa00e3 \
                    file://node_modules/object-is/LICENSE;md5=d22b3eb619d81197fd4f3ca47c2c1ea5 \
                    file://node_modules/deep-equal/LICENSE;md5=ec4e94fe7abda03e2e44a713b0908a07 \
                    file://node_modules/thunky/LICENSE;md5=0033175ba371b569c73d23fd726c37e8 \
                    file://node_modules/semver/LICENSE;md5=82703a69f6d7411dde679954c2fd9dca \
                    file://node_modules/tweetnacl/LICENSE;md5=911690f51af322440237a253d695d19f \
                    file://node_modules/source-map-support/LICENSE.md;md5=f433e270f6b1d088c38b279d53048f5e \
                    file://node_modules/array-flatten/LICENSE;md5=44088ba57cb871a58add36ce51b8de08 \
                    file://node_modules/bonjour-hap/LICENSE;md5=e3e60dbc1d2936fce98e157d8c24eb77 \
                    file://node_modules/q/LICENSE;md5=007eeb0530ef13fc1dc164e14af28a64 \
                    file://node_modules/is-weakmap/LICENSE;md5=c18cc44449ec61c93b216bf74e6c4fa4 \
                    file://node_modules/object-keys/LICENSE;md5=0026e638d7d5c5f2768864ce0074f8ad \
                    file://node_modules/futoin-hkdf/LICENSE;md5=3b83ef96387f14655fc854ddc3c6bd57 \
                    file://node_modules/define-properties/LICENSE;md5=53ffc646fdb83e45279cfe7105e5157b \
                    file://node_modules/safe-buffer/LICENSE;md5=badd5e91c737e7ffdf10b40c1f907761 \
                    file://node_modules/commander/LICENSE;md5=25851d4d10d6611a12d5571dab945a00 \
                    file://node_modules/which-collection/LICENSE;md5=c18cc44449ec61c93b216bf74e6c4fa4 \
                    file://node_modules/mkdirp/LICENSE;md5=b2d989bc186e7f6b418a5fdd5cc0b56b \
                    file://node_modules/source-map/LICENSE;md5=b1ca6dbc0075d56cbd9931a75566cd44 \
                    file://node_modules/dns-packet/LICENSE;md5=42014010547e55bd3bcac2fec8c45624 \
                    file://node_modules/supports-color/license;md5=915042b5df33c31a6db2b37eadaa00e3 \
                    file://node_modules/is-regex/LICENSE;md5=d22b3eb619d81197fd4f3ca47c2c1ea5 \
                    file://node_modules/is-weakset/LICENSE;md5=c18cc44449ec61c93b216bf74e6c4fa4 \
                    file://node_modules/minimist/LICENSE;md5=aea1cde69645f4b99be4ff7ca9abcce1 \
                    file://node_modules/string.prototype.trimend/LICENSE;md5=1e241a19d2d112b1db1a5c1c23216939 \
                    file://node_modules/string.prototype.trimend/node_modules/es-abstract/LICENSE;md5=53ffc646fdb83e45279cfe7105e5157b \
                    file://node_modules/es-to-primitive/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/available-typed-arrays/LICENSE;md5=838b75dc6028daf3e04e57871b7ad3ed \
                    file://node_modules/side-channel/LICENSE;md5=375dc7ca936a14e9c29418d5263bd066 \
                    file://package.json;md5=0ec594f2537a7f19cef58d1a1bf3e49e \
                    file://node_modules/ansi-styles/package.json;md5=ab7a71ab9f6b46acda83106c5f34e6e3 \
                    file://node_modules/array-filter/package.json;md5=ff4d1fe4117d4c52a998f4c7e00d4020 \
                    file://node_modules/array-flatten/package.json;md5=e566945b6e9974dc25bc6908977dbd5e \
                    file://node_modules/available-typed-arrays/package.json;md5=78d7149f2ea7e67704e4567c5d64b732 \
                    file://node_modules/bonjour-hap/package.json;md5=a5082857e95dbdae3fb87ac18d83ec2a \
                    file://node_modules/buffer-from/package.json;md5=d708da6e9719b6b3a221aedc7e1cbf92 \
                    file://node_modules/chalk/package.json;md5=300316f2f886e93742252367296574eb \
                    file://node_modules/color-convert/package.json;md5=370b0177fdb4368f0a688ffa48559ecf \
                    file://node_modules/color-name/package.json;md5=ef649e8b7be42bba6d4fa34aca7e126a \
                    file://node_modules/commander/package.json;md5=559c22783d1b9bc3462653c0aedb7eb4 \
                    file://node_modules/debug/package.json;md5=923be017f4e97d24c734b4f8f6405abb \
                    file://node_modules/decimal.js/package.json;md5=f7f716975df755d777c181c146afd53e \
                    file://node_modules/deep-equal/package.json;md5=a8cabc66e608c59e64531d25fe81a39a \
                    file://node_modules/define-properties/package.json;md5=78d159123901bac44c44e358eb28f652 \
                    file://node_modules/dns-packet/package.json;md5=dcf5dbf116e3d46880ef68a13d8504a0 \
                    file://node_modules/es-abstract/package.json;md5=598f9354e3584c899389eb4332235d41 \
                    file://node_modules/es-get-iterator/node_modules/es-abstract/package.json;md5=3720b90ac03834e1b9c21e8c06b7d4a3 \
                    file://node_modules/es-get-iterator/package.json;md5=18083b72947f9356f554c4228888cf56 \
                    file://node_modules/es-to-primitive/package.json;md5=b183238ced55e20cc222932f965376a2 \
                    file://node_modules/fast-srp-hap/package.json;md5=4cd0896272776986883f5423d1467ee2 \
                    file://node_modules/foreach/package.json;md5=a01d1df68e94076fe2a3c72b92a7b661 \
                    file://node_modules/function-bind/package.json;md5=f453e26c8d3482b4c3736f53303b4ec5 \
                    file://node_modules/futoin-hkdf/package.json;md5=cc346f571ba5f9ea21b2e9be20917982 \
                    file://node_modules/hap-nodejs/package.json;md5=94821f6d895a32235ee628fe789dfe53 \
                    file://node_modules/has/package.json;md5=2fee243336ba5aeebed1e0145472cd49 \
                    file://node_modules/has-flag/package.json;md5=636dbe2c8d513ad850070def501122bf \
                    file://node_modules/has-symbols/package.json;md5=24e9d883e10a6e4a622fcf6357ee5383 \
                    file://node_modules/ip/package.json;md5=be29a19795a2a19e8a18060a724849da \
                    file://node_modules/is-arguments/package.json;md5=ef233192ba7280452977c9c6ab37e39c \
                    file://node_modules/is-bigint/package.json;md5=60da7688d85ef2c9efea6648ee210309 \
                    file://node_modules/is-boolean-object/package.json;md5=20bcc965e8a5b750cae1f53ddf054a93 \
                    file://node_modules/is-callable/package.json;md5=f0005414e43f459c76f2d0bad7715afa \
                    file://node_modules/is-date-object/package.json;md5=b0366c20b2ee192e8155131e25328520 \
                    file://node_modules/is-map/package.json;md5=b12683ae53a3096b903848be4ccf1e29 \
                    file://node_modules/is-negative-zero/package.json;md5=b33541f9f941d8762a39d3c93f6fcfe8 \
                    file://node_modules/is-number-object/package.json;md5=9503724b90119c827489fbc725a3be14 \
                    file://node_modules/is-regex/package.json;md5=e6ee8cf81fa574554a655f5a74cfb30e \
                    file://node_modules/is-set/package.json;md5=8a93bb6153d7ac0322469bf37c4a2637 \
                    file://node_modules/is-string/package.json;md5=e3f997aa93037bb419bf3cab67c4a336 \
                    file://node_modules/is-symbol/package.json;md5=cf109cd5c94e334929842882585e5cb6 \
                    file://node_modules/is-typed-array/node_modules/es-abstract/package.json;md5=3720b90ac03834e1b9c21e8c06b7d4a3 \
                    file://node_modules/is-typed-array/package.json;md5=7aad21d4e9a26249507aa916db2c12a1 \
                    file://node_modules/is-weakmap/package.json;md5=558a0b262f8044bcde20766776a5c3fc \
                    file://node_modules/is-weakset/package.json;md5=25450a6576f92b04a6615b19eb1afb74 \
                    file://node_modules/isarray/package.json;md5=7efcba14ed8a9ab09e4c277b21936b7a \
                    file://node_modules/minimist/package.json;md5=84505571ecc56b8071068f44de7c79b2 \
                    file://node_modules/mkdirp/package.json;md5=3b5ba3c4a04a8b0520bd0d392cf1c48f \
                    file://node_modules/ms/package.json;md5=b3ea7267a23f72028e774742792b114a \
                    file://node_modules/multicast-dns/package.json;md5=c0fb8dfea43642a032e4350fff24b7a6 \
                    file://node_modules/multicast-dns-service-types/package.json;md5=85ced0d312e6520ecee5e2578375d056 \
                    file://node_modules/node-persist/package.json;md5=3e5d120c883684a5dfe1312b717f0a5c \
                    file://node_modules/object-inspect/package.json;md5=57e2064f8faf3540e38138ea72a3da80 \
                    file://node_modules/object-is/package.json;md5=d50cd1e00e4f8cf59059b761daebac42 \
                    file://node_modules/object-keys/package.json;md5=f008c51545b8133eebae07e2046d241f \
                    file://node_modules/object.assign/package.json;md5=39b15f3a21d2ca35b29d6d8c34622892 \
                    file://node_modules/q/package.json;md5=bacb3d8cd07d67e040dd6c0ebe06fad2 \
                    file://node_modules/qrcode-terminal/package.json;md5=ab8dc5a699d7f7435cf98830283a6b11 \
                    file://node_modules/regexp.prototype.flags/node_modules/es-abstract/package.json;md5=3720b90ac03834e1b9c21e8c06b7d4a3 \
                    file://node_modules/regexp.prototype.flags/package.json;md5=288e33b5e607e05b778b31c59e05dd2e \
                    file://node_modules/safe-buffer/package.json;md5=b206856c7ef099626bf28cdc5498787a \
                    file://node_modules/semver/package.json;md5=9c8e85514fe8e9c88606a5227b4028f3 \
                    file://node_modules/side-channel/package.json;md5=3c8886bb23b047e47d1662ed2c25606f \
                    file://node_modules/source-map/package.json;md5=5f7feb368962c3130c5accf22ffd047c \
                    file://node_modules/source-map-support/package.json;md5=6a8932761d99e7d465d691bd4bfab6ab \
                    file://node_modules/string.prototype.trimend/node_modules/es-abstract/package.json;md5=3720b90ac03834e1b9c21e8c06b7d4a3 \
                    file://node_modules/string.prototype.trimend/package.json;md5=ab3703a11172f796ecb3359718ec94e2 \
                    file://node_modules/string.prototype.trimstart/node_modules/es-abstract/package.json;md5=3720b90ac03834e1b9c21e8c06b7d4a3 \
                    file://node_modules/string.prototype.trimstart/package.json;md5=e364e925184cb00b7101e181b0587c87 \
                    file://node_modules/supports-color/package.json;md5=9bd5f75e8324cc8e0b633c59f1c4b60b \
                    file://node_modules/thunky/package.json;md5=d9829aafe187190540bdfe7f214ece40 \
                    file://node_modules/tweetnacl/package.json;md5=465636a7ba9577a8c684caf3c01fbe9a \
                    file://node_modules/which-boxed-primitive/package.json;md5=a3f9e9b5162b9cb2eba7db176194a810 \
                    file://node_modules/which-collection/package.json;md5=c0c713522f83090d76e0e27786cfa07f \
                    file://node_modules/which-typed-array/node_modules/es-abstract/package.json;md5=3720b90ac03834e1b9c21e8c06b7d4a3 \
                    file://node_modules/which-typed-array/package.json;md5=b8bbcced1aebf174e51dc11adb0952b5"

SRC_URI = " \
    npm://registry.npmjs.org/;package=homebridge;version=${PV} \
    npmsw://${THISDIR}/${BPN}/npm-shrinkwrap.json \
    file://config.json \
    file://homebridge \
    file://homebridge.service \
    "

S = "${WORKDIR}/npm"

RDEPENDS_${PN} += " \
    nodejs-npm \
    homebridge-config-ui-x \
    "

inherit npm

do_install_append() {
	install -d ${D}/var/lib/homebridge/
	install -m 644 ${WORKDIR}/config.json ${D}/var/lib/homebridge/

	install -d ${D}${sysconfdir}/default/
	install -m 644 ${WORKDIR}/homebridge ${D}${sysconfdir}/default/

	if ${@bb.utils.contains('DISTRO_FEATURES', 'systemd', 'true', 'false', d)}; then
		install -d ${D}${systemd_unitdir}/system
		install -m 644 ${WORKDIR}/homebridge.service ${D}${systemd_unitdir}/system
	fi
}

FILES_${PN} += " \
	/var/lib/homebridge/config.json \
	${sysconfdir}/default/homebridge \
    ${systemd_unitdir}/system/homebridge.service \
"

SYSTEMD_SERVICE_${PN} = "homebridge.service"

LICENSE_${PN} = "Apache-2.0"
LICENSE_${PN}-ansi-styles = "MIT"
LICENSE_${PN}-array-filter = "MIT"
LICENSE_${PN}-array-flatten = "MIT"
LICENSE_${PN}-available-typed-arrays = "MIT"
LICENSE_${PN}-bonjour-hap = "MIT"
LICENSE_${PN}-buffer-from = "MIT"
LICENSE_${PN}-chalk = "MIT"
LICENSE_${PN}-color-convert = "MIT"
LICENSE_${PN}-color-name = "MIT"
LICENSE_${PN}-commander = "MIT"
LICENSE_${PN}-debug = "MIT"
LICENSE_${PN}-decimaljs = "MIT"
LICENSE_${PN}-deep-equal = "MIT"
LICENSE_${PN}-define-properties = "MIT"
LICENSE_${PN}-dns-packet = "MIT"
LICENSE_${PN}-es-abstract = "MIT"
LICENSE_${PN}-es-get-iterator-es-abstract = "MIT"
LICENSE_${PN}-es-get-iterator = "MIT"
LICENSE_${PN}-es-to-primitive = "MIT"
LICENSE_${PN}-fast-srp-hap = "MIT"
LICENSE_${PN}-foreach = "MIT"
LICENSE_${PN}-function-bind = "MIT"
LICENSE_${PN}-futoin-hkdf = "Apache-2.0"
LICENSE_${PN}-hap-nodejs = "Apache-2.0"
LICENSE_${PN}-has = "MIT"
LICENSE_${PN}-has-flag = "MIT"
LICENSE_${PN}-has-symbols = "MIT"
LICENSE_${PN}-ip = "MIT"
LICENSE_${PN}-is-arguments = "MIT"
LICENSE_${PN}-is-bigint = "MIT"
LICENSE_${PN}-is-boolean-object = "MIT"
LICENSE_${PN}-is-callable = "MIT"
LICENSE_${PN}-is-date-object = "MIT"
LICENSE_${PN}-is-map = "MIT"
LICENSE_${PN}-is-negative-zero = "MIT"
LICENSE_${PN}-is-number-object = "MIT"
LICENSE_${PN}-is-regex = "MIT"
LICENSE_${PN}-is-set = "MIT"
LICENSE_${PN}-is-string = "MIT"
LICENSE_${PN}-is-symbol = "MIT"
LICENSE_${PN}-is-typed-array-es-abstract = "MIT"
LICENSE_${PN}-is-typed-array = "MIT"
LICENSE_${PN}-is-weakmap = "MIT"
LICENSE_${PN}-is-weakset = "MIT"
LICENSE_${PN}-isarray = "MIT"
LICENSE_${PN}-minimist = "MIT"
LICENSE_${PN}-mkdirp = "MIT"
LICENSE_${PN}-ms = "MIT"
LICENSE_${PN}-multicast-dns = "MIT"
LICENSE_${PN}-multicast-dns-service-types = "MIT"
LICENSE_${PN}-node-persist = "MIT"
LICENSE_${PN}-object-inspect = "MIT"
LICENSE_${PN}-object-is = "MIT"
LICENSE_${PN}-object-keys = "MIT"
LICENSE_${PN}-objectassign = "MIT"
LICENSE_${PN}-q = "MIT"
LICENSE_${PN}-qrcode-terminal = "Apache-2.0"
LICENSE_${PN}-regexpprototypeflags-es-abstract = "MIT"
LICENSE_${PN}-regexpprototypeflags = "MIT"
LICENSE_${PN}-safe-buffer = "MIT"
LICENSE_${PN}-semver = "ISC"
LICENSE_${PN}-side-channel = "MIT"
LICENSE_${PN}-source-map = "BSD-3-Clause"
LICENSE_${PN}-source-map-support = "MIT"
LICENSE_${PN}-stringprototypetrimend-es-abstract = "MIT"
LICENSE_${PN}-stringprototypetrimend = "MIT"
LICENSE_${PN}-stringprototypetrimstart-es-abstract = "MIT"
LICENSE_${PN}-stringprototypetrimstart = "MIT"
LICENSE_${PN}-supports-color = "MIT"
LICENSE_${PN}-thunky = "MIT"
LICENSE_${PN}-tweetnacl = "Unlicense"
LICENSE_${PN}-which-boxed-primitive = "MIT"
LICENSE_${PN}-which-collection = "MIT"
LICENSE_${PN}-which-typed-array-es-abstract = "MIT"
LICENSE_${PN}-which-typed-array = "MIT"
