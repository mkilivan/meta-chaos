SUMMARY = "HomeKit support for the impatient"
LICENSE = "Unlicense & MIT & ISC & Apache-2.0"
LIC_FILES_CHKSUM = "file://LICENSE;md5=34f8c1142fd6208a8be89399cb521df9 \
                    file://node_modules/multicast-dns-service-types/LICENSE;md5=a75272c6b584d0f8e2c1676b4e72469e \
                    file://node_modules/color-convert/LICENSE;md5=9bdadfc9fbb3ab8d5a6d591bdbd52811 \
                    file://node_modules/is-date-object/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/hap-nodejs/LICENSE;md5=34f8c1142fd6208a8be89399cb521df9 \
                    file://node_modules/@homebridge/ciao/LICENSE;md5=5e8341d17ac9ff00fd2a4b74ee5d0b5a \
                    file://node_modules/color-name/LICENSE;md5=d301869b39e08b33665b7c4f16b8e41d \
                    file://node_modules/fast-srp-hap/LICENSE;md5=ebe2e123fdf76caa6bf6762e1133b698 \
                    file://node_modules/multicast-dns/LICENSE;md5=a75272c6b584d0f8e2c1676b4e72469e \
                    file://node_modules/object.assign/LICENSE;md5=2b439ca9e99134dee172a7cc6d989174 \
                    file://node_modules/fast-deep-equal/LICENSE;md5=ea87ade09b9e6da4f2e47904a4ee137b \
                    file://node_modules/is-negative-zero/LICENSE;md5=d22b3eb619d81197fd4f3ca47c2c1ea5 \
                    file://node_modules/unbox-primitive/LICENSE;md5=375dc7ca936a14e9c29418d5263bd066 \
                    file://node_modules/regexp.prototype.flags/LICENSE;md5=de214a0e2991ba4bb802f96348cbb1ce \
                    file://node_modules/function-bind/LICENSE;md5=e7417c1a8ad83f88bcac21ad440d48b2 \
                    file://node_modules/foreach/LICENSE;md5=b2225091caf5effa363ef7016fa2b0ba \
                    file://node_modules/isarray/LICENSE;md5=a5df515ef062cc3affd8c0ae59c059ec \
                    file://node_modules/is-callable/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/is-map/LICENSE;md5=c18cc44449ec61c93b216bf74e6c4fa4 \
                    file://node_modules/which-typed-array/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/is-typed-array/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/ms/license.md;md5=fd56fd5f1860961dfa92d313167c37a6 \
                    file://node_modules/is-string/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/is-number-object/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/buffer-from/LICENSE;md5=46513463e8f7d9eb671a243f0083b2c6 \
                    file://node_modules/is-set/LICENSE;md5=c18cc44449ec61c93b216bf74e6c4fa4 \
                    file://node_modules/es-abstract/LICENSE;md5=53ffc646fdb83e45279cfe7105e5157b \
                    file://node_modules/jsonfile/LICENSE;md5=423f377ade95936f6fe009b1c137bfdb \
                    file://node_modules/is-arguments/LICENSE;md5=d22b3eb619d81197fd4f3ca47c2c1ea5 \
                    file://node_modules/object-inspect/LICENSE;md5=288162f1d1bfa064f127f2b42d2a656f \
                    file://node_modules/debug/LICENSE;md5=ddd815a475e7338b0be7a14d8ee35a99 \
                    file://node_modules/string.prototype.trimstart/LICENSE;md5=1e241a19d2d112b1db1a5c1c23216939 \
                    file://node_modules/yallist/LICENSE;md5=82703a69f6d7411dde679954c2fd9dca \
                    file://node_modules/is-boolean-object/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/has-symbols/LICENSE;md5=afee57a289508ed4df3456667778aaf6 \
                    file://node_modules/has/LICENSE-MIT;md5=d000afc3c9ff3501a5610197db76a246 \
                    file://node_modules/is-symbol/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/call-bind/LICENSE;md5=0eb2c73daa0ecf037cbdf3d0bb0c98d5 \
                    file://node_modules/qrcode-terminal/LICENSE;md5=beed67299fff1e7b91b5e4c3e43b505b \
                    file://node_modules/es-get-iterator/LICENSE;md5=375dc7ca936a14e9c29418d5263bd066 \
                    file://node_modules/which-boxed-primitive/LICENSE;md5=375dc7ca936a14e9c29418d5263bd066 \
                    file://node_modules/is-bigint/LICENSE;md5=291be6f19f64188a89ffd5180aea06f7 \
                    file://node_modules/has-flag/license;md5=915042b5df33c31a6db2b37eadaa00e3 \
                    file://node_modules/ansi-styles/license;md5=915042b5df33c31a6db2b37eadaa00e3 \
                    file://node_modules/chalk/license;md5=915042b5df33c31a6db2b37eadaa00e3 \
                    file://node_modules/object-is/LICENSE;md5=d22b3eb619d81197fd4f3ca47c2c1ea5 \
                    file://node_modules/deep-equal/LICENSE;md5=ec4e94fe7abda03e2e44a713b0908a07 \
                    file://node_modules/thunky/LICENSE;md5=0033175ba371b569c73d23fd726c37e8 \
                    file://node_modules/universalify/LICENSE;md5=a734c6ad6e37a515025ac5e8e90ef786 \
                    file://node_modules/semver/LICENSE;md5=82703a69f6d7411dde679954c2fd9dca \
                    file://node_modules/tweetnacl/LICENSE;md5=911690f51af322440237a253d695d19f \
                    file://node_modules/source-map-support/LICENSE.md;md5=f433e270f6b1d088c38b279d53048f5e \
                    file://node_modules/array-flatten/LICENSE;md5=44088ba57cb871a58add36ce51b8de08 \
                    file://node_modules/bonjour-hap/LICENSE;md5=e3e60dbc1d2936fce98e157d8c24eb77 \
                    file://node_modules/q/LICENSE;md5=007eeb0530ef13fc1dc164e14af28a64 \
                    file://node_modules/is-weakmap/LICENSE;md5=c18cc44449ec61c93b216bf74e6c4fa4 \
                    file://node_modules/object-keys/LICENSE;md5=0026e638d7d5c5f2768864ce0074f8ad \
                    file://node_modules/futoin-hkdf/LICENSE;md5=3b83ef96387f14655fc854ddc3c6bd57 \
                    file://node_modules/fs-extra/LICENSE;md5=ea817882455c03503f7d014a8f54f095 \
                    file://node_modules/define-properties/LICENSE;md5=53ffc646fdb83e45279cfe7105e5157b \
                    file://node_modules/safe-buffer/LICENSE;md5=badd5e91c737e7ffdf10b40c1f907761 \
                    file://node_modules/tslib/CopyrightNotice.txt;md5=36b68802c0e2531ae0fe6cd30619652a \
                    file://node_modules/tslib/LICENSE.txt;md5=f938d99cba29007eeae26d80a9a4cfa6 \
                    file://node_modules/commander/LICENSE;md5=25851d4d10d6611a12d5571dab945a00 \
                    file://node_modules/which-collection/LICENSE;md5=c18cc44449ec61c93b216bf74e6c4fa4 \
                    file://node_modules/mkdirp/LICENSE;md5=b2d989bc186e7f6b418a5fdd5cc0b56b \
                    file://node_modules/has-bigints/LICENSE;md5=375dc7ca936a14e9c29418d5263bd066 \
                    file://node_modules/source-map/LICENSE;md5=b1ca6dbc0075d56cbd9931a75566cd44 \
                    file://node_modules/dns-packet/LICENSE;md5=42014010547e55bd3bcac2fec8c45624 \
                    file://node_modules/lru-cache/LICENSE;md5=82703a69f6d7411dde679954c2fd9dca \
                    file://node_modules/supports-color/license;md5=915042b5df33c31a6db2b37eadaa00e3 \
                    file://node_modules/graceful-fs/LICENSE;md5=fd63805fd8e3797063b247781e5ee6e4 \
                    file://node_modules/is-regex/LICENSE;md5=d22b3eb619d81197fd4f3ca47c2c1ea5 \
                    file://node_modules/is-weakset/LICENSE;md5=c18cc44449ec61c93b216bf74e6c4fa4 \
                    file://node_modules/minimist/LICENSE;md5=aea1cde69645f4b99be4ff7ca9abcce1 \
                    file://node_modules/string.prototype.trimend/LICENSE;md5=1e241a19d2d112b1db1a5c1c23216939 \
                    file://node_modules/es-to-primitive/LICENSE;md5=5db8fa3e421a3211e6a3dc68544da455 \
                    file://node_modules/at-least-node/LICENSE;md5=dd1cf73adc91a2a56db663c2a84b0bab \
                    file://node_modules/get-intrinsic/LICENSE;md5=0eb2c73daa0ecf037cbdf3d0bb0c98d5 \
                    file://node_modules/available-typed-arrays/LICENSE;md5=838b75dc6028daf3e04e57871b7ad3ed \
                    file://node_modules/side-channel/LICENSE;md5=375dc7ca936a14e9c29418d5263bd066 \
                    file://package.json;md5=3a8248f31b91eb2a03e5b6b1a588ea64 \
                    file://node_modules/@homebridge/ciao/package.json;md5=222adb421b0d8ac421e2334ddec4183a \
                    file://node_modules/ansi-styles/package.json;md5=ab7a71ab9f6b46acda83106c5f34e6e3 \
                    file://node_modules/array-filter/package.json;md5=ff4d1fe4117d4c52a998f4c7e00d4020 \
                    file://node_modules/array-flatten/package.json;md5=e566945b6e9974dc25bc6908977dbd5e \
                    file://node_modules/at-least-node/package.json;md5=3979df18a05f450cba974c1d8257d345 \
                    file://node_modules/available-typed-arrays/package.json;md5=78d7149f2ea7e67704e4567c5d64b732 \
                    file://node_modules/bonjour-hap/package.json;md5=7c0b998596fdee9c917f362183a53210 \
                    file://node_modules/buffer-from/package.json;md5=d708da6e9719b6b3a221aedc7e1cbf92 \
                    file://node_modules/call-bind/package.json;md5=9a9c527cb02ee791af16291838ddc217 \
                    file://node_modules/chalk/package.json;md5=f4cdc53f17139d976da561b4526138da \
                    file://node_modules/color-convert/package.json;md5=370b0177fdb4368f0a688ffa48559ecf \
                    file://node_modules/color-name/package.json;md5=ef649e8b7be42bba6d4fa34aca7e126a \
                    file://node_modules/commander/package.json;md5=559c22783d1b9bc3462653c0aedb7eb4 \
                    file://node_modules/debug/package.json;md5=d084346a689161b3c5a11df81c28acc4 \
                    file://node_modules/deep-equal/package.json;md5=c9a9822ddab0e09244af3c61dfb9966c \
                    file://node_modules/define-properties/package.json;md5=78d159123901bac44c44e358eb28f652 \
                    file://node_modules/dns-packet/package.json;md5=dcf5dbf116e3d46880ef68a13d8504a0 \
                    file://node_modules/es-abstract/package.json;md5=6138ef4002b457ffc9e55c03d61b6d89 \
                    file://node_modules/es-get-iterator/package.json;md5=7dbff00d78e54ede6ad148a6de37a763 \
                    file://node_modules/es-to-primitive/package.json;md5=b183238ced55e20cc222932f965376a2 \
                    file://node_modules/fast-deep-equal/package.json;md5=da1199afd6b2d7a1eaa9e30acd35f4e6 \
                    file://node_modules/fast-srp-hap/package.json;md5=0f146e4f1d8dfbff33cfd2130b8f7feb \
                    file://node_modules/foreach/package.json;md5=a01d1df68e94076fe2a3c72b92a7b661 \
                    file://node_modules/fs-extra/package.json;md5=2cc14a7007d6d2b959051d6724ceaebd \
                    file://node_modules/function-bind/package.json;md5=f453e26c8d3482b4c3736f53303b4ec5 \
                    file://node_modules/futoin-hkdf/package.json;md5=a26e40c9a5d8c26ec1ae6355fb76a552 \
                    file://node_modules/get-intrinsic/package.json;md5=5445ffe22cf286a1bf0d086678090e95 \
                    file://node_modules/graceful-fs/package.json;md5=e6ed8ee5ea4fb97e55c3e6a02efbd294 \
                    file://node_modules/hap-nodejs/package.json;md5=3cd1688ee6fa71c665c757408fd32167 \
                    file://node_modules/has/package.json;md5=2fee243336ba5aeebed1e0145472cd49 \
                    file://node_modules/has-bigints/package.json;md5=26c50341514448a5a6d90c788b1faf02 \
                    file://node_modules/has-flag/package.json;md5=636dbe2c8d513ad850070def501122bf \
                    file://node_modules/has-symbols/package.json;md5=097fa07992b708eb1ef0c6a26aaf56f5 \
                    file://node_modules/ip/package.json;md5=be29a19795a2a19e8a18060a724849da \
                    file://node_modules/is-arguments/package.json;md5=6f788ee47fc7755920347e9eb018951e \
                    file://node_modules/is-bigint/package.json;md5=92e5ff35d29406d54267b6be2685f939 \
                    file://node_modules/is-boolean-object/package.json;md5=f60764be245b6b13ef48cb8b023dd53c \
                    file://node_modules/is-callable/package.json;md5=14b71c2c0ccaea677617499eaf809e17 \
                    file://node_modules/is-date-object/package.json;md5=b0366c20b2ee192e8155131e25328520 \
                    file://node_modules/is-map/package.json;md5=ded27e6ac8b91fe7cbe3942e3849fb3f \
                    file://node_modules/is-negative-zero/package.json;md5=0ae5dfcc8fa729e4c20bbc3bcbe47a20 \
                    file://node_modules/is-number-object/package.json;md5=9503724b90119c827489fbc725a3be14 \
                    file://node_modules/is-regex/package.json;md5=89d799c0cef5f4bb778f42abeb2fe070 \
                    file://node_modules/is-set/package.json;md5=e3dc7015994f3d20e6bfb79477401d97 \
                    file://node_modules/is-string/package.json;md5=e3f997aa93037bb419bf3cab67c4a336 \
                    file://node_modules/is-symbol/package.json;md5=cf109cd5c94e334929842882585e5cb6 \
                    file://node_modules/is-typed-array/package.json;md5=fa1ba2be36e5967d74f5d808485b3fcc \
                    file://node_modules/is-weakmap/package.json;md5=558a0b262f8044bcde20766776a5c3fc \
                    file://node_modules/is-weakset/package.json;md5=25450a6576f92b04a6615b19eb1afb74 \
                    file://node_modules/isarray/package.json;md5=7efcba14ed8a9ab09e4c277b21936b7a \
                    file://node_modules/jsonfile/package.json;md5=e27717dfc4310ca320bc5321b2ea7f96 \
                    file://node_modules/lru-cache/package.json;md5=5facce3b29b46c909e27bd642d950a3f \
                    file://node_modules/minimist/package.json;md5=84505571ecc56b8071068f44de7c79b2 \
                    file://node_modules/mkdirp/package.json;md5=3b5ba3c4a04a8b0520bd0d392cf1c48f \
                    file://node_modules/ms/package.json;md5=b3ea7267a23f72028e774742792b114a \
                    file://node_modules/multicast-dns/package.json;md5=c0fb8dfea43642a032e4350fff24b7a6 \
                    file://node_modules/multicast-dns-service-types/package.json;md5=85ced0d312e6520ecee5e2578375d056 \
                    file://node_modules/node-persist/package.json;md5=3e5d120c883684a5dfe1312b717f0a5c \
                    file://node_modules/object-inspect/package.json;md5=2ad3bcb07922db79be54fb3330e8dd33 \
                    file://node_modules/object-is/package.json;md5=8abb23990a29b0d11f5fc7166e5f4278 \
                    file://node_modules/object-keys/package.json;md5=f008c51545b8133eebae07e2046d241f \
                    file://node_modules/object.assign/package.json;md5=b005579b3fe07346a5ff1b4940f3a23d \
                    file://node_modules/q/package.json;md5=bacb3d8cd07d67e040dd6c0ebe06fad2 \
                    file://node_modules/qrcode-terminal/package.json;md5=ab8dc5a699d7f7435cf98830283a6b11 \
                    file://node_modules/regexp.prototype.flags/package.json;md5=a4d8fe1856e64d9312e138c1514f1b35 \
                    file://node_modules/safe-buffer/package.json;md5=b206856c7ef099626bf28cdc5498787a \
                    file://node_modules/semver/package.json;md5=e9c03558862c56298e0a595817448cc2 \
                    file://node_modules/side-channel/package.json;md5=ee22c26e53803fd87d3cbb2e2a46ebc7 \
                    file://node_modules/source-map/package.json;md5=5f7feb368962c3130c5accf22ffd047c \
                    file://node_modules/source-map-support/package.json;md5=6a8932761d99e7d465d691bd4bfab6ab \
                    file://node_modules/string.prototype.trimend/package.json;md5=c1cbd5e43f214bfbd9e58987f36bfbab \
                    file://node_modules/string.prototype.trimstart/package.json;md5=956012c0a8e99075ea7314f5390b4b5a \
                    file://node_modules/supports-color/package.json;md5=9bd5f75e8324cc8e0b633c59f1c4b60b \
                    file://node_modules/thunky/package.json;md5=d9829aafe187190540bdfe7f214ece40 \
                    file://node_modules/tslib/package.json;md5=1f87e9dca650038c2463c3f7eeba2ffa \
                    file://node_modules/tweetnacl/package.json;md5=465636a7ba9577a8c684caf3c01fbe9a \
                    file://node_modules/unbox-primitive/package.json;md5=cdb4692cc1b45c9bee8365743f0045c6 \
                    file://node_modules/universalify/package.json;md5=f85107bad060054cbc7853837533df25 \
                    file://node_modules/which-boxed-primitive/package.json;md5=15162a8fd256d3b885a5df0213cf5f27 \
                    file://node_modules/which-collection/package.json;md5=c0c713522f83090d76e0e27786cfa07f \
                    file://node_modules/which-typed-array/package.json;md5=54fc9f53ce2aac0914b2a994269b67a9 \
                    file://node_modules/yallist/package.json;md5=b15d27bf2cf04083fef9389ce68aa620"

SRC_URI = "npm://registry.npmjs.org/;package=homebridge;version=${PV} \
           npmsw://${THISDIR}/${BPN}/npm-shrinkwrap.json \
           file://config.json \
           file://homebridge \
           file://homebridge.service \
           "

S = "${WORKDIR}/npm"

RDEPENDS:${PN} += " \
    nodejs-npm \
    homebridge-config-ui-x \
    "

inherit npm

do_install:append() {
	install -d ${D}/var/lib/homebridge/
	install -m 644 ${WORKDIR}/config.json ${D}/var/lib/homebridge/

	install -d ${D}${sysconfdir}/default/
	install -m 644 ${WORKDIR}/homebridge ${D}${sysconfdir}/default/

	if ${@bb.utils.contains('DISTRO_FEATURES', 'systemd', 'true', 'false', d)}; then
		install -d ${D}${systemd_unitdir}/system
		install -m 644 ${WORKDIR}/homebridge.service ${D}${systemd_unitdir}/system
	fi
}

FILES:${PN} += " \
	/var/lib/homebridge/config.json \
	${sysconfdir}/default/homebridge \
    ${systemd_unitdir}/system/homebridge.service \
"

inherit systemd

SYSTEMD_SERVICE:${PN} = "${@bb.utils.contains('DISTRO_FEATURES','systemd','homebridge.service','',d)}"

LICENSE:${PN} = "Apache-2.0"
LICENSE:${PN}-ansi-styles = "MIT"
LICENSE:${PN}-array-filter = "MIT"
LICENSE:${PN}-array-flatten = "MIT"
LICENSE:${PN}-at-least-node = "ISC"
LICENSE:${PN}-available-typed-arrays = "MIT"
LICENSE:${PN}-bonjour-hap = "MIT"
LICENSE:${PN}-buffer-from = "MIT"
LICENSE:${PN}-call-bind = "MIT"
LICENSE:${PN}-chalk = "MIT"
LICENSE:${PN}-color-convert = "MIT"
LICENSE:${PN}-color-name = "MIT"
LICENSE:${PN}-commander = "MIT"
LICENSE:${PN}-debug = "MIT"
LICENSE:${PN}-deep-equal = "MIT"
LICENSE:${PN}-define-properties = "MIT"
LICENSE:${PN}-dns-packet = "MIT"
LICENSE:${PN}-es-abstract = "MIT"
LICENSE:${PN}-es-get-iterator = "MIT"
LICENSE:${PN}-es-to-primitive = "MIT"
LICENSE:${PN}-fast-deep-equal = "MIT"
LICENSE:${PN}-fast-srp-hap = "MIT"
LICENSE:${PN}-foreach = "MIT"
LICENSE:${PN}-fs-extra = "MIT"
LICENSE:${PN}-function-bind = "MIT"
LICENSE:${PN}-futoin-hkdf = "Apache-2.0"
LICENSE:${PN}-get-intrinsic = "MIT"
LICENSE:${PN}-graceful-fs = "ISC"
LICENSE:${PN}-hap-nodejs = "Apache-2.0"
LICENSE:${PN}-has = "MIT"
LICENSE:${PN}-has-bigints = "MIT"
LICENSE:${PN}-has-flag = "MIT"
LICENSE:${PN}-has-symbols = "MIT"
LICENSE:${PN}-ip = "MIT"
LICENSE:${PN}-is-arguments = "MIT"
LICENSE:${PN}-is-bigint = "MIT"
LICENSE:${PN}-is-boolean-object = "MIT"
LICENSE:${PN}-is-callable = "MIT"
LICENSE:${PN}-is-date-object = "MIT"
LICENSE:${PN}-is-map = "MIT"
LICENSE:${PN}-is-negative-zero = "MIT"
LICENSE:${PN}-is-number-object = "MIT"
LICENSE:${PN}-is-regex = "MIT"
LICENSE:${PN}-is-set = "MIT"
LICENSE:${PN}-is-string = "MIT"
LICENSE:${PN}-is-symbol = "MIT"
LICENSE:${PN}-is-typed-array = "MIT"
LICENSE:${PN}-is-weakmap = "MIT"
LICENSE:${PN}-is-weakset = "MIT"
LICENSE:${PN}-isarray = "MIT"
LICENSE:${PN}-jsonfile = "MIT"
LICENSE:${PN}-lru-cache = "ISC"
LICENSE:${PN}-minimist = "MIT"
LICENSE:${PN}-mkdirp = "MIT"
LICENSE:${PN}-ms = "MIT"
LICENSE:${PN}-multicast-dns = "MIT"
LICENSE:${PN}-multicast-dns-service-types = "MIT"
LICENSE:${PN}-node-persist = "MIT"
LICENSE:${PN}-object-inspect = "MIT"
LICENSE:${PN}-object-is = "MIT"
LICENSE:${PN}-object-keys = "MIT"
LICENSE:${PN}-objectassign = "MIT"
LICENSE:${PN}-q = "MIT"
LICENSE:${PN}-qrcode-terminal = "Apache-2.0"
LICENSE:${PN}-regexpprototypeflags = "MIT"
LICENSE:${PN}-safe-buffer = "MIT"
LICENSE:${PN}-semver = "ISC"
LICENSE:${PN}-side-channel = "MIT"
LICENSE:${PN}-source-map = "BSD-3-Clause"
LICENSE:${PN}-source-map-support = "MIT"
LICENSE:${PN}-stringprototypetrimend = "MIT"
LICENSE:${PN}-stringprototypetrimstart = "MIT"
LICENSE:${PN}-supports-color = "MIT"
LICENSE:${PN}-thunky = "MIT"
LICENSE:${PN}-tslib = "MIT"
LICENSE:${PN}-tweetnacl = "Unlicense"
LICENSE:${PN}-unbox-primitive = "MIT"
LICENSE:${PN}-universalify = "MIT"
LICENSE:${PN}-which-boxed-primitive = "MIT"
LICENSE:${PN}-which-collection = "MIT"
LICENSE:${PN}-which-typed-array = "MIT"
LICENSE:${PN}-yallist = "ISC"
